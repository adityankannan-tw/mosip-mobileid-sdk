{"version":3,"names":["React","useEffect","StyleSheet","Text","View","TouchableOpacity","ImageBackground","Camera","authenticateFace","camera","FaceAuth","props","authentication","setAuthentication","useState","previewVisible","setPreviewVisible","capturedImage","setCapturedImage","cameraType","setCameraType","Constants","Type","front","onValidationSuccess","retakePicture","switchCamera","back","authenticatePhoto","photo","takePictureAsync","result","data","CameraPreview","backgroundColor","flex","width","height","uri","styles","imgBackground","flexDirection","borderRadius","justifyContent","alignItems","color","fontSize","alignContent","container","r","position","bottom","right","fontWeight","padding","alignSelf","create"],"sources":["index.tsx"],"sourcesContent":["import React, { useEffect } from \"react\";\nimport {\n  StyleSheet,\n  Text,\n  View,\n  TouchableOpacity,\n  ImageBackground,\n} from \"react-native\";\nimport { Camera, CameraCapturedPicture } from \"expo-camera\";\nimport authenticateFace from \"./AuthenticationService\";\n\nlet camera: Camera;\n\nexport const FaceAuth: React.FC<FaceAuthProps> = (props: FaceAuthProps) => {\n  const [authentication, setAuthentication] = React.useState<boolean | null>(\n    null\n  );\n  const [previewVisible, setPreviewVisible] = React.useState(false);\n  const [capturedImage, setCapturedImage] =\n    React.useState<CameraCapturedPicture | null>(null);\n  const [cameraType, setCameraType] = React.useState(Camera.Constants.Type.front);\n\n  useEffect(() => {\n    if (authentication) {\n      props.onValidationSuccess();\n    }\n  }, [authentication]);\n\n  const retakePicture = () => {\n    setCapturedImage(null);\n    setPreviewVisible(false);\n  };\n\n  const switchCamera = () => {\n    setCameraType(cameraType === \"back\" ? Camera.Constants.Type.front : Camera.Constants.Type.back);\n  };\n\n  const authenticatePhoto = async () => {\n    const photo: CameraCapturedPicture = await camera.takePictureAsync();\n    setPreviewVisible(true);\n    setCapturedImage(photo);\n    const result: boolean = authenticateFace(capturedImage, props.data);\n    setAuthentication(result);\n  };\n\n  const CameraPreview = ({ photo, retakePicture }: any) => {\n    return (\n      <View\n        style={{\n          backgroundColor: \"transparent\",\n          flex: 1,\n          width: \"100%\",\n          height: \"100%\",\n        }}\n      >\n        <ImageBackground source={{ uri: photo.uri }} style={{ flex: 1 }}>\n          <View style={styles.imgBackground}>\n            <View style={{ flexDirection: \"column\" }}>\n              {authentication === true ? (\n                <Text\n                  style={{\n                    borderRadius: 4,\n                    backgroundColor: \"#fff\",\n                    flexDirection: \"row\",\n                    justifyContent: \"center\",\n                    alignItems: \"center\",\n                    height: 40,\n                    color: \"green\",\n                    fontSize: 20,\n                    alignContent: \"center\",\n                  }}\n                >\n                  Authentication Successful\n                </Text>\n              ) : (\n                <TouchableOpacity\n                  onPress={retakePicture}\n                  style={{\n                    borderRadius: 4,\n                    backgroundColor: \"#14274e\",\n                    flexDirection: \"row\",\n                    justifyContent: \"center\",\n                    alignItems: \"center\",\n                    height: 40,\n                  }}\n                >\n                  <Text style={{ color: \"red\", fontSize: 20 }}>\n                    Authentication failed, Try again\n                  </Text>\n                </TouchableOpacity>\n              )}\n            </View>\n          </View>\n        </ImageBackground>\n      </View>\n    );\n  };\n\n  return (\n    <View style={styles.container}>\n      <View style={{ flex: 1, width: \"100%\" }}>\n        {previewVisible && capturedImage ? (\n          <CameraPreview\n            photo={capturedImage}\n            authenticatePhoto={authenticatePhoto}\n            retakePicture={retakePicture}\n          />\n        ) : (\n          <Camera\n            type={cameraType}\n            style={{ flex: 1 }}\n            ref={(r: Camera) => {\n              camera = r;\n            }}\n          >\n            <View\n              style={{\n                flex: 1,\n                width: \"100%\",\n                backgroundColor: \"transparent\",\n                flexDirection: \"row\",\n              }}\n            >\n              <View\n                style={{\n                  position: \"absolute\",\n                  bottom: 30,\n                  flex: 1,\n                  right: \"5%\",\n                  flexDirection: \"row\",\n                  justifyContent: \"space-between\",\n                }}\n              >\n                <TouchableOpacity onPress={switchCamera}>\n                  <Text\n                    style={{\n                      backgroundColor: \"#14274e\",\n                      alignItems: \"center\",\n                      fontSize: 20,\n                      color: \"#fff\",\n                      fontWeight: \"bold\",\n                    }}\n                  >\n                    Switch Camera\n                  </Text>\n                </TouchableOpacity>\n              </View>\n              <View\n                style={{\n                  position: \"absolute\",\n                  bottom: 0,\n                  flexDirection: \"row\",\n                  flex: 1,\n                  width: \"100%\",\n                  padding: 20,\n                  justifyContent: \"space-between\",\n                }}\n              >\n                <View\n                  style={{ alignSelf: \"center\", flex: 1, alignItems: \"center\" }}\n                >\n                  <TouchableOpacity\n                    onPress={authenticatePhoto}\n                    style={{\n                      width: 70,\n                      height: 70,\n                      bottom: 0,\n                      borderRadius: 50,\n                      backgroundColor: \"#fff\",\n                    }}\n                  />\n                </View>\n              </View>\n            </View>\n          </Camera>\n        )}\n      </View>\n    </View>\n  );\n};\n\nexport interface FaceAuthProps {\n  data: string;\n  onValidationSuccess: () => void;\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: \"#fff\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  imgBackground: {\n    flex: 1,\n    flexDirection: \"column\",\n    padding: 15,\n    justifyContent: \"flex-end\",\n  },\n});"],"mappings":"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"}