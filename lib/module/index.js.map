{"version":3,"names":["React","useEffect","StyleSheet","Text","View","TouchableOpacity","ImageBackground","Camera","CameraType","authenticateFace","camera","FaceAuth","props","authentication","setAuthentication","useState","previewVisible","setPreviewVisible","capturedImage","setCapturedImage","cameraType","setCameraType","front","onValidationSuccess","retakePicture","switchCamera","back","authenticatePhoto","photo","takePictureAsync","result","data","CameraPreview","backgroundColor","flex","width","height","uri","styles","imgBackground","flexDirection","borderRadius","justifyContent","alignItems","color","fontSize","alignContent","container","r","position","bottom","right","fontWeight","padding","alignSelf","create"],"sources":["index.tsx"],"sourcesContent":["import React, { useEffect } from \"react\";\r\nimport {\r\n  StyleSheet,\r\n  Text,\r\n  View,\r\n  TouchableOpacity,\r\n  ImageBackground,\r\n} from \"react-native\";\r\nimport { Camera, CameraCapturedPicture } from \"expo-camera\";\r\nimport { CameraType } from \"expo-camera/build/Camera.types\";\r\nimport authenticateFace from \"./AuthenticationService\";\r\n\r\nlet camera: Camera;\r\n\r\nconst FaceAuth: React.FC<FaceAuthProps> = (props: FaceAuthProps) => {\r\n  const [authentication, setAuthentication] = React.useState<boolean | null>(\r\n    null\r\n  );\r\n  const [previewVisible, setPreviewVisible] = React.useState(false);\r\n  const [capturedImage, setCapturedImage] =\r\n    React.useState<CameraCapturedPicture | null>(null);\r\n  const [cameraType, setCameraType] = React.useState(CameraType.front);\r\n\r\n  useEffect(() => {\r\n    if (authentication) {\r\n      props.onValidationSuccess();\r\n    }\r\n  }, [authentication]);\r\n\r\n  const retakePicture = () => {\r\n    setCapturedImage(null);\r\n    setPreviewVisible(false);\r\n  };\r\n\r\n  const switchCamera = () => {\r\n    setCameraType(cameraType === \"back\" ? CameraType.front : CameraType.back);\r\n  };\r\n\r\n  const authenticatePhoto = async () => {\r\n    const photo: CameraCapturedPicture = await camera.takePictureAsync();\r\n    setPreviewVisible(true);\r\n    setCapturedImage(photo);\r\n    const result: boolean = authenticateFace(capturedImage, props.data);\r\n    setAuthentication(result);\r\n  };\r\n\r\n  const CameraPreview = ({ photo, retakePicture }: any) => {\r\n    return (\r\n      <View\r\n        style={{\r\n          backgroundColor: \"transparent\",\r\n          flex: 1,\r\n          width: \"100%\",\r\n          height: \"100%\",\r\n        }}\r\n      >\r\n        <ImageBackground source={{ uri: photo.uri }} style={{ flex: 1 }}>\r\n          <View style={styles.imgBackground}>\r\n            <View style={{ flexDirection: \"column\" }}>\r\n              {authentication === true ? (\r\n                <Text\r\n                  style={{\r\n                    borderRadius: 4,\r\n                    backgroundColor: \"#fff\",\r\n                    flexDirection: \"row\",\r\n                    justifyContent: \"center\",\r\n                    alignItems: \"center\",\r\n                    height: 40,\r\n                    color: \"green\",\r\n                    fontSize: 20,\r\n                    alignContent: \"center\",\r\n                  }}\r\n                >\r\n                  Authentication Successful\r\n                </Text>\r\n              ) : (\r\n                <TouchableOpacity\r\n                  onPress={retakePicture}\r\n                  style={{\r\n                    borderRadius: 4,\r\n                    backgroundColor: \"#14274e\",\r\n                    flexDirection: \"row\",\r\n                    justifyContent: \"center\",\r\n                    alignItems: \"center\",\r\n                    height: 40,\r\n                  }}\r\n                >\r\n                  <Text style={{ color: \"red\", fontSize: 20 }}>\r\n                    Authentication failed, Try again\r\n                  </Text>\r\n                </TouchableOpacity>\r\n              )}\r\n            </View>\r\n          </View>\r\n        </ImageBackground>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      <View style={{ flex: 1, width: \"100%\" }}>\r\n        {previewVisible && capturedImage ? (\r\n          <CameraPreview\r\n            photo={capturedImage}\r\n            authenticatePhoto={authenticatePhoto}\r\n            retakePicture={retakePicture}\r\n          />\r\n        ) : (\r\n          <Camera\r\n            type={cameraType}\r\n            style={{ flex: 1 }}\r\n            ref={(r: Camera) => {\r\n              camera = r;\r\n            }}\r\n          >\r\n            <View\r\n              style={{\r\n                flex: 1,\r\n                width: \"100%\",\r\n                backgroundColor: \"transparent\",\r\n                flexDirection: \"row\",\r\n              }}\r\n            >\r\n              <View\r\n                style={{\r\n                  position: \"absolute\",\r\n                  bottom: 30,\r\n                  flex: 1,\r\n                  right: \"5%\",\r\n                  flexDirection: \"row\",\r\n                  justifyContent: \"space-between\",\r\n                }}\r\n              >\r\n                <TouchableOpacity onPress={switchCamera}>\r\n                  <Text\r\n                    style={{\r\n                      backgroundColor: \"#14274e\",\r\n                      alignItems: \"center\",\r\n                      fontSize: 20,\r\n                      color: \"#fff\",\r\n                      fontWeight: \"bold\",\r\n                    }}\r\n                  >\r\n                    Switch Camera\r\n                  </Text>\r\n                </TouchableOpacity>\r\n              </View>\r\n              <View\r\n                style={{\r\n                  position: \"absolute\",\r\n                  bottom: 0,\r\n                  flexDirection: \"row\",\r\n                  flex: 1,\r\n                  width: \"100%\",\r\n                  padding: 20,\r\n                  justifyContent: \"space-between\",\r\n                }}\r\n              >\r\n                <View\r\n                  style={{ alignSelf: \"center\", flex: 1, alignItems: \"center\" }}\r\n                >\r\n                  <TouchableOpacity\r\n                    onPress={authenticatePhoto}\r\n                    style={{\r\n                      width: 70,\r\n                      height: 70,\r\n                      bottom: 0,\r\n                      borderRadius: 50,\r\n                      backgroundColor: \"#fff\",\r\n                    }}\r\n                  />\r\n                </View>\r\n              </View>\r\n            </View>\r\n          </Camera>\r\n        )}\r\n      </View>\r\n    </View>\r\n  );\r\n};\r\n\r\nexport interface FaceAuthProps {\r\n  data: string;\r\n  onValidationSuccess: () => void;\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: \"#fff\",\r\n    alignItems: \"center\",\r\n    justifyContent: \"center\",\r\n  },\r\n  imgBackground: {\r\n    flex: 1,\r\n    flexDirection: \"column\",\r\n    padding: 15,\r\n    justifyContent: \"flex-end\",\r\n  },\r\n});\r\n\r\nexport default FaceAuth;\r\n"],"mappings":"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"}