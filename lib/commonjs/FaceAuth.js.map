{"version":3,"names":["camera","FaceAuth","React","Component","constructor","props","setState","capturedImage","previewVisible","cameraType","state","CameraType","front","back","photo","takePictureAsync","result","authenticateFace","data","authentication","console","log","retakePicture","backgroundColor","flex","width","height","uri","styles","imgBackground","flexDirection","borderRadius","justifyContent","alignItems","color","fontSize","alignContent","Error","render","container","__retakePicture","r","mode","FaceDetector","FaceDetectorMode","fast","detectLandmarks","FaceDetectorLandmarks","all","runClassifications","FaceDetectorClassifications","minDetectionInterval","tracking","position","bottom","right","__switchCamera","fontWeight","padding","alignSelf","authenticatePhoto","StyleSheet","create"],"sources":["FaceAuth.tsx"],"sourcesContent":["import React, { Props, useEffect, useState } from 'react';\r\nimport {StyleSheet, Text, View, TouchableOpacity, Alert, ImageBackground, Image, Route} from 'react-native'\r\nimport {Camera, CameraCapturedPicture, CameraType} from 'expo-camera'\r\nimport authenticateFace from \"./AuthenticationService\"\r\nimport * as FaceDetector from 'expo-face-detector';\r\n\r\nlet camera:Camera;\r\n\r\nexport interface FaceAuthProps {\r\n  data:string;\r\n  onValidationSuccess: () => void;\r\n};\r\n\r\ntype State = {\r\n  authentication: boolean;\r\n  previewVisible: boolean;\r\n  capturedImage: CameraCapturedPicture|null;\r\n  cameraType: CameraType;\r\n\r\n};\r\n\r\nexport default class FaceAuth extends React.Component<FaceAuthProps, State> {\r\n\r\n\r\n  constructor(props: FaceAuthProps) {\r\n    super(props);\r\n\r\n    if (props.data === null) {\r\n      throw new Error('Please send VC face image');\r\n    }\r\n\r\n    this.state = {\r\n      authentication: false,\r\n      previewVisible: false,\r\n      capturedImage: null,\r\n      cameraType: CameraType.front\r\n    };\r\n  }\r\n\r\n  __retakePicture = () => {\r\n    this.setState({\r\n      capturedImage: null,\r\n      previewVisible: false\r\n    });\r\n    \r\n  }\r\n  \r\n  __switchCamera = () => {\r\n    this.setState({cameraType: (this.state.cameraType === 'back' ? CameraType.front : CameraType.back)});\r\n  }\r\n\r\n  authenticatePhoto = async () => {\r\n    const photo:CameraCapturedPicture = await camera.takePictureAsync();\r\n    this.setState({capturedImage: photo, previewVisible: true});\r\n\r\n    const result:boolean = authenticateFace(this.state.capturedImage, this.props.data);\r\n    this.setState({authentication: result});\r\n    console.log('result ----- ' + result);\r\n  }\r\n\r\n  CameraPreview = ({photo, retakePicture}: any) => {\r\n    return (\r\n        \r\n      <View style={{backgroundColor: 'transparent', flex: 1, width: '100%', height: '100%'}}>\r\n        <ImageBackground source={{uri: photo.uri}} style={{flex: 1}}>\r\n          <View style={styles.imgBackground}>\r\n            <View style={{flexDirection: 'column'}}>\r\n              {this.state.authentication === true ? \r\n                    (<Text style={{borderRadius: 4, backgroundColor: '#fff',\r\n                    flexDirection: 'row', justifyContent: 'center', alignItems: 'center', height: 40, color: 'green',fontSize: 20, alignContent: 'center'}}>Authentication Successful</Text>) : \r\n                    (<TouchableOpacity onPress={retakePicture} style={{borderRadius: 4, backgroundColor: '#14274e',\r\n                    flexDirection: 'row', justifyContent: 'center', alignItems: 'center', height: 40}}>\r\n                    <Text style={{ color: 'red', fontSize: 20}}>Authentication failed, Try again</Text>\r\n                  </TouchableOpacity>)}\r\n            </View>\r\n          </View>\r\n        </ImageBackground>\r\n      </View>\r\n    )\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <View style={styles.container}>\r\n      <View style={{flex: 1,width: '100%'}}>\r\n          {this.state.previewVisible ? (\r\n            <this.CameraPreview photo={this.state.capturedImage} retakePicture={this.__retakePicture} />\r\n          ) : (\r\n            <Camera type={this.state.cameraType} style={{flex: 1}} ref={(r:Camera) => { camera = r }}\r\n            faceDetectorSettings={{mode: FaceDetector.FaceDetectorMode.fast, detectLandmarks: FaceDetector.FaceDetectorLandmarks.all,\r\n              runClassifications: FaceDetector.FaceDetectorClassifications.all, minDetectionInterval: 100, tracking: true}}>\r\n              <View style={{flex: 1, width: '100%', backgroundColor: 'transparent', flexDirection: 'row'}}>\r\n                <View style={{position: 'absolute', bottom: 30, flex: 1, right: '5%',  flexDirection: 'row', justifyContent: 'space-between'}}>\r\n                  <TouchableOpacity onPress={this.__switchCamera}>\r\n                    <Text style={{backgroundColor: '#14274e',\r\n                    alignItems: 'center',fontSize: 20,color: '#fff', fontWeight:'bold'}}>Switch Camera</Text>\r\n                  </TouchableOpacity>\r\n                </View>\r\n                <View style={{position: 'absolute', bottom: 0,flexDirection: 'row',flex: 1,width: '100%',padding: 20,justifyContent: 'space-between'}}>\r\n                  <View style={{alignSelf: 'center', flex: 1,alignItems: 'center'}}>\r\n                    <TouchableOpacity onPress={this.authenticatePhoto} style={{width: 70,height: 70,bottom: 0,borderRadius: 50, backgroundColor: '#fff'}}/>\r\n                  </View>\r\n                </View>\r\n              </View>\r\n            </Camera>\r\n          )}\r\n        </View>\r\n    </View>\r\n    )\r\n}\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: '#fff',\r\n    alignItems: 'center',\r\n    justifyContent: 'center'\r\n  },\r\n  imgBackground: {\r\n    flex: 1,flexDirection: 'column',padding: 15,justifyContent: 'flex-end'\r\n  }\r\n})\r\n\r\nfunction render() {\r\n    throw new Error('Function not implemented.');\r\n}\r\n"],"mappings":"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"}